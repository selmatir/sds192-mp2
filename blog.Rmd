---
title: "Mini-Project 2"
author: "Your Name Here"
date: "March 24, 2017"
output: html_document
---


## Loading the data


```{r, include=FALSE}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")

library(dplyr)
library(tidyverse)
library(ggplot2)
library(ggthemes)
```

```{r, message=FALSE, warning=FALSE}
candH <- candidates %>%
        filter(cand_office == "H", cand_office_state == "CA") %>%
        select(cand_id, cand_name, cand_party_affiliation, cand_election_yr)

names(house_elections)[names(house_elections) == "fec_id"] <- "cand_id"

elections <- house_elections %>%
            select(cand_id, general_votes, ge_winner)

contrib <- contributions %>%
          filter(transaction_type == "24E") %>%
          select(transaction_amt, cand_id)

table1 <- candH %>%
          full_join(elections, by = "cand_id") %>%
          filter(!is.na(ge_winner)) 

table2 <- table1 %>%
          full_join(contrib, by = "cand_id") %>%
          arrange(cand_name) %>%
          group_by(cand_name) %>%
          mutate(total_money = sum(transaction_amt),
                  total_votes = sum(general_votes)) %>%
          filter(cand_party_affiliation== "DEM" | cand_party_affiliation=="REP", !is.na(total_money))

plot1 <- ggplot(data=table2, aes(x=total_votes, y=total_money)) +
        geom_point(aes(colour=cand_party_affiliation, shape=ge_winner)) +
        geom_smooth(method = "lm") +
        ggtitle("Correlation between the number of votes and contributions \na candidate to the House elections received") +
        xlab("Number of Votes (millions)") +
        ylab("Amount of Contribution (millions of dollars)") +
        theme_economist() +
        scale_x_continuous(limits=c(0,16000000), breaks=c(0,10000000,16000000), labels = c("0","10","16")) +
       scale_y_continuous(limits=c(0,3600000), breaks=c(0,2000000,3600000),labels=c("0","2","4")) +
        scale_color_discrete(name = "party") +
        theme(legend.title = element_text(size = 11),
              legend.text = element_text(size = 9),
              legend.position = "right",
              axis.title = element_text(size = 11))
      

plot1

```

filter:
california
24E transactions: Independent expenditure advocating election of candidate
house elections
candidates from DEM and REP parties
