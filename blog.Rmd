---
title: "Mini-Project 2"
author: "Selma Tir & Emma Dennis-Knieriem"
date: "March 26, 2017"
output: html_document
---

##2012 General House Election in New York


####The Data
The data was obtained from the Federal Election Commission based on the 2011-2012 federal election cycle. The number of votes and amount of contribution variables have been mapped to the visual dimension position using a scatterplot. Party affiliation has been mapped to the visual dimension color, with blue for democrats and red for republicans, as is traditional in United States politics. The outcome of the election has been mapped to the visual dimension shape with "Win" represented by a triangle and "Loss" represented by a cirlce.

```{r, include=FALSE}
#Loading the data
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")

#Loading packages
library(dplyr)
library(tidyverse)
library(ggplot2)
library(ggthemes)
```

```{r, message=FALSE, warning=FALSE}
#From 'candidates', filter only the candidates running for seats in the House of Representative for the state of New York and select ID, name, party affiliation, and election year.
candH <- candidates %>%
        filter(cand_office == "H", cand_office_state == "NY") %>%
        select(cand_id, cand_name, cand_party_affiliation, cand_election_yr)

#Rename ID variable from "house_elections" data frame as the same string from previous frame, allowing a join of these two frames by this variable.
names(house_elections)[names(house_elections) == "fec_id"] <- "cand_id"

#From 'house_elections', select ID, number of votes from general election, and whether or not each candidate won the general election. Assuming that candidates who got zero votes in the general election did not make it past primary elections, and filter these candidates out.
elections <- house_elections %>%
            select(cand_id, general_votes, ge_winner) %>%
            filter(general_votes > 0)

#From 'contributions', filter transaction type '24E', the independent expenditure advocating the election of a candidate. Select only the transaction amount and the candidate ID.
contrib <- contributions %>%
          filter(transaction_type == "24E", transaction_amt > 0) %>%
          select(transaction_amt, cand_id)

#Joining data frames containing information about the candidates (name, party affiliations, etc.) and general election results (number of votes received, whether or not each candidate won).
table1 <- candH %>%
          full_join(elections, by = "cand_id") %>%
          filter(!is.na(ge_winner)) 

#Joining previous data frame with contribution information to show the total money each candidate received. Filter only the candidates who ran as a democrat or a republican.
table2 <- table1 %>%
          full_join(contrib, by = "cand_id") %>%
          group_by(cand_name) %>%
          mutate(total_money = sum(transaction_amt)) %>%
          filter(cand_party_affiliation== "DEM" | cand_party_affiliation=="REP", !is.na(total_money))

#Define function 'plotscale', which creates a plot of 'Amount of Contribution' vs. 'Number of Votes'. This allows multiple plots to be generated from 'table2' when passed upper limit (y-axis), title, break, and label parameters. The x-axis is fixed for easy comparisons between plots made by this function.
plotscale <- function(Upper_Limit, Y_Title, YBreak1, YBreak2, YBreak3, YBreak4, YBreak5, YBreak6, YLab1, YLab2, YLab3, YLab4, YLab5, YLab6) {
            ggplot(data=table2, aes(x=general_votes, y=total_money)) +
        geom_point(aes(colour=cand_party_affiliation, shape=ge_winner), size=2.5) +
        ggtitle("Number of Votes and Contributions in \nNew York General House Election") +
        xlab("Number of Votes (thousands)") +
        ylab(Y_Title) +
        theme_economist() +
        scale_color_manual(name = "Party", labels = c("DEM", "REP"), values = c("#0006CC", "#CC0000")) +
        scale_shape_discrete(name = "Election's outcome", labels = c("Loss", "Win")) +
        scale_x_continuous(limits=c(0,220000), breaks=c(0,100000,200000), labels = c("0","100","200")) +
        scale_y_continuous(limits=c(0,Upper_Limit), breaks=c(YBreak1, YBreak2, YBreak3, YBreak4, YBreak5, YBreak6), labels=c(YLab1, YLab2, YLab3, YLab4, YLab5, YLab6)) +
        theme(plot.title = element_text(hjust = 0.5),
              legend.title = element_text(size = 11),
              legend.text = element_text(size = 9),
              legend.position = "right",
              axis.title = element_text(size = 11))}
```
####The Graph
  
```{r, message=FALSE, warning=FALSE}
#Generate two plots using 'plotscale' function. The first plot includes the observations from 'table2'.
plotscale(1300000, "Amount of Contribution (in millions of dollars)", 0, 250000, 500000, 750000, 1000000, 1250000, 0, 0.25, "0.50", 0.75, "1.00", 1.25)

#Using 'plotscale', generate a plot that is like the first one, but zoomed in on the clustered data, removing outliers who received lots of contributions.
plotscale(500000, "Amount of Contribution (in thousands of dollars)", 0, 100000, 200000, 300000, 400000, 500000, 0, 100, 200, 300, 400, 500)
```

These graphs show the relationship between the number of votes (in thousands) and the amount of contribution (independent expenditure advocating the election of the candidate) democrats and replublicans received for the 2012 General House election in New York state. 


####What can we learn?
According to these data, most of the candidates who were elected by New York state to the House of Representatives in 2012 were democrats who received less than $100,000 in contributions for their campaign. While the average contribution a republican candidate received was higher than that of a democrat, it appears like the average number of votes a democrat received was higher than that of a republican candidate. It is unsurprising that democrats won more seats than republicans since more democrats ran for the general election. 

However, the graphs show that more democrats rewon their seats. As of November 2012, the democratic party from New York held 21 seats in the House of Representatives, while the republican party only hold 8. As of after the 2012 house elections, the democratic party held the same number of seats while the republicans lost 2 seats.

Additionally, the two republican outliers who each received half a million dollars more than the other candidates did not win seats to the House of Representatives. The fact that New York state generally votes for democrats, or "votes blue", might explian this discrepancy. 

####Any surprises?
One would expect that the more campaign funds a candidate receives, the more votes he or she also obtains. However, the two graphs disprove this theory with empirical data. 

Indeed, most of the candidates who won the election with the greatest number of votes (about 175,000 and higher) received some of the smallest amounts of contribution (about 25,000 and under).

The influence of contributions on the outcome of an election is hence more convoluted and can not be expressed by a simple correlation between money and votes. 

